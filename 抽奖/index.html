<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>全屏手动抽奖（多数量奖品）</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Microsoft Yahei", sans-serif;
        }

        html, body {
            height: 100%;
            overflow: hidden;
            position: relative;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c 0%, #2c3e50 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2vw;
        }

        .lottery-container {
            width: 100%;
            max-width: 900px;
            height: calc(100vh - 4vw);
            max-height: 800px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 2vw;
            position: relative;
            overflow: hidden;
        }

        .lottery-title {
            font-size: clamp(24px, 6vw, 50px);
            color: #ffffff;
            font-weight: 800;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            text-align: center;
            letter-spacing: 2px;
            z-index: 1;
            max-height: 15vh;
            overflow: hidden;
        }

        .remaining-prizes {
            font-size: clamp(16px, 3vw, 24px);
            color: #a8d8ff;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.1);
            padding: 0.8vw 2vw;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 1;
            max-height: 10vh;
            overflow: hidden;
        }

        .lottery-display {
            width: 100%;
            flex-grow: 1;
            min-height: 200px;
            max-height: 50vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 30px;
            color: #ffffff;
            font-weight: 900;
            text-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
            letter-spacing: 4px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            z-index: 1;
            padding: 3vw;
        }

        .text-container {
            max-width: 100%;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            max-height: 100%;
            overflow: hidden;
        }

        .display-text {
            font-size: clamp(20px, 6vw, 60px);
            line-height: 1.2;
            word-wrap: break-word;
            word-break: break-word;
            max-width: 100%;
            overflow: hidden;
        }

        .prize-img {	
			position:absolute;
			left:0;
			right:0;
			top:0;
			z-index: -1;
			bottom:0;
			width:100%;
			height:100%;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            object-fit: contain;
        }

        .lottery-display::before {
            content: "";
            position: absolute;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(98, 189, 255, 0.1), transparent);
            animation: bgRotate 8s linear infinite;
            z-index: -1;
        }

        @keyframes bgRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .lottery-display::after {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: lightSlide 3s ease-in-out infinite;
        }

        @keyframes lightSlide {
            0% { left: -100%; }
            100% { left: 200%; }
        }

        .btn-container {
            display: flex;
            gap: 2vw;
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
            z-index: 1;
            max-height: 20vh;
            padding: 1vw 0;
        }

        .lottery-btn {
            padding: clamp(14px, 3vw, 24px) clamp(30px, 8vw, 60px);
            font-size: clamp(20px, 5vw, 32px);
            border: none;
            border-radius: 100px;
            color: white;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            flex: 1;
            min-width: 150px;
            max-width: 300px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .start-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .start-btn:hover {
            transform: translateY(-6px);
            box-shadow: 0 15px 40px rgba(79, 172, 254, 0.4);
        }

        .stop-btn {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .stop-btn:hover {
            transform: translateY(-6px);
            box-shadow: 0 15px 40px rgba(250, 112, 154, 0.4);
        }

        .lottery-btn:disabled {
            background: #444;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.6;
        }

        @keyframes textRoll {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            50% { transform: translateY(-15px) scale(1.02); opacity: 0.9; }
            100% { transform: translateY(15px) scale(0.98); opacity: 1; }
        }

        .rolling {
            animation: textRoll 0.08s infinite alternate cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        /* 中奖弹窗样式 */
        .prize-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            padding: 4vw;
            overflow: auto;
        }

        .modal-content {
            text-align: center;
            max-width: 600px;
            width: 100%;
            padding: 3vw 0;
            /* 添加弹窗出现动画 */
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .prize-modal.active .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .modal-img {
            width: 100%;
            height: 50vh;
            border-radius: 20px;
            margin-bottom: 3vw;
            box-shadow: 0 15px 40px rgba(255, 215, 0, 0.3);
            max-height: 50vh;
            object-fit: contain;
        }

        .modal-title {
            font-size: clamp(30px, 8vw, 60px);
            color: #ffd700;
            margin-bottom: 2vw;
            text-shadow: 0 5px 20px rgba(255, 215, 0, 0.5);
            overflow: hidden;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .modal-desc {
            font-size: clamp(18px, 4vw, 30px);
            color: #ffffff;
            margin-bottom: 4vw;
            line-height: 1.4;
            word-wrap: break-word;
            word-break: break-word;
            max-height: 20vh;
            overflow: auto;
        }

        .close-modal {
            padding: clamp(12px, 2.5vw, 20px) clamp(25px, 6vw, 50px);
            font-size: clamp(18px, 4vw, 28px);
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            border: none;
            border-radius: 80px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(238, 90, 82, 0.3);
            white-space: nowrap;
        }

        .close-modal:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(238, 90, 82, 0.5);
        }

        /* 烟花效果样式 */
        .firework {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            z-index: 10000;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="lottery-container">
        <h1 class="lottery-title">幸运抽奖</h1>
        <div class="remaining-prizes">剩余奖品总数：<span id="total-remaining">28</span></div>
        
        <div class="lottery-display">
            <div class="text-container">
                <img src="" alt="奖品图片" class="prize-img" id="display-img" style="display: none;">
                <div class="display-text" id="display-text">点击开始抽奖</div>
            </div>
        </div>
        
        <div class="btn-container">
            <button class="lottery-btn start-btn" id="start-btn">开始</button>
            <button class="lottery-btn stop-btn" id="stop-btn" disabled>停止</button>
        </div>
    </div>

    <!-- 中奖弹窗 -->
    <div class="prize-modal" id="prize-modal">
        <div class="modal-content">
            <img src="" alt="中奖奖品" class="modal-img" id="modal-img">
            <h2 class="modal-title">恭喜中奖！</h2>
            <p class="modal-desc" id="modal-desc"></p>
            <button class="close-modal" id="close-modal">确认</button>
        </div>
    </div>

    <!-- 中奖音效 -->
    <audio id="win-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" type="audio/mpeg">
    </audio>

    <script>
        // 核心奖品数组
        const prizeList = [
            { index: 0, name: "如鹰展翅上腾", count: 2, img: "image/0.png" },
            { index: 1, name: "爱不止息", count: 3, img: "image/1.png" },
            { index: 2, name: "祝福满满——平安喜乐", count: 1, img: "image/2.png" },
            { index: 3, name: "常常喜乐", count: 2, img: "image/6.png" },
            { index: 4, name: "抬头仰望，凡事都有美意", count: 2, img: "image/3.png" },
            { index: 5, name: "抬头仰望，凡是都有美意——平安喜乐", count: 2, img: "image/4.png" },   
            { index: 6, name: "稳行高处", count: 1, img: "image/5.png" },
            { index: 7, name: "彼此相爱", count: 2, img: "image/7.png" },
        ];

        // DOM元素
        const startBtn = document.getElementById("start-btn");
        const stopBtn = document.getElementById("stop-btn");
        const displayText = document.getElementById("display-text");
        const displayImg = document.getElementById("display-img");
        const totalRemainingEl = document.getElementById("total-remaining");
        const prizeModal = document.getElementById("prize-modal");
        const modalImg = document.getElementById("modal-img");
        const modalDesc = document.getElementById("modal-desc");
        const closeModal = document.getElementById("close-modal");
        const winSound = document.getElementById("win-sound");

        let isRolling = false;
        let rollInterval;
        let currentPrizeIndex = 0;

        // 计算剩余奖品总数
        function calculateTotalRemaining() {
            return prizeList.reduce((total, prize) => total + prize.count, 0);
        }

        // 更新剩余奖品显示
        function updateRemainingDisplay() {
            totalRemainingEl.textContent = calculateTotalRemaining();
        }

        // 滚动抽奖
        function startRolling() {
            if (isRolling) return;
            if (calculateTotalRemaining() === 0) {
                alert("所有奖品已抽完！");
                return;
            }

            isRolling = true;
            startBtn.disabled = true;
            stopBtn.disabled = false;
            displayText.classList.add("rolling");

            // 随机滚动奖品
            rollInterval = setInterval(() => {
                const availablePrizes = prizeList.filter(prize => prize.count > 0);
                if (availablePrizes.length === 0) {
                    clearInterval(rollInterval);
                    return;
                }

                const randomIndex = Math.floor(Math.random() * availablePrizes.length);
                currentPrizeIndex = availablePrizes[randomIndex].index;
                const currentPrize = prizeList[currentPrizeIndex];

                // 更新显示
                displayImg.src = currentPrize.img;
                displayImg.style.display = "block";
                displayText.textContent = currentPrize.name;
            }, 100);
        }

        // 创建烟花效果
        function createFireworks(count = 10) {
            // 清除之前的烟花
            document.querySelectorAll('.firework').forEach(fw => fw.remove());
            
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    // 随机位置
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight * 0.8;
                    
                    // 随机颜色
                    const colors = ['#ff3864', '#ffdd57', '#41b883', '#00d8ff', '#ff7d00', '#9b4dca'];
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    
                    // 创建烟花粒子
                    explodeFirework(x, y, color);
                }, i * 200);
            }
        }

        // 烟花爆炸效果
        function explodeFirework(x, y, color) {
            const particleCount = 50; // 粒子数量
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('firework');
                particle.style.background = color;
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                document.body.appendChild(particle);
                
                // 随机方向和距离
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * 100 + 50;
                
                // 计算终点位置
                const endX = x + Math.cos(angle) * distance;
                const endY = y + Math.sin(angle) * distance;
                
                // 随机动画时间
                const duration = Math.random() * 1 + 1;
                
                // 应用动画
                particle.style.transition = `all ${duration}s cubic-bezier(0.1, 0.8, 0.9, 1)`;
                
                // 触发动画
                setTimeout(() => {
                    particle.style.transform = `translate(${endX - x}px, ${endY - y}px)`;
                    particle.style.opacity = '0';
                }, 10);
                
                // 动画结束后移除粒子
                setTimeout(() => {
                    particle.remove();
                }, duration * 1000);
            }
        }

        // 停止滚动并中奖
        function stopRolling() {
            if (!isRolling) return;

            clearInterval(rollInterval);
            isRolling = false;
            startBtn.disabled = false;
            stopBtn.disabled = true;
            displayText.classList.remove("rolling");

            // 获取当前选中的奖品
            const winningPrize = prizeList[currentPrizeIndex];
            
            // 减少奖品数量
            if (winningPrize.count > 0) {
                winningPrize.count--;
            }

            // 更新剩余奖品显示
            updateRemainingDisplay();

            // 显示中奖弹窗
            modalImg.src = winningPrize.img;
            modalDesc.textContent = `恭喜获得：${winningPrize.name}`;

            // 播放中奖音效
            winSound.currentTime = 0;
            winSound.play().catch(e => console.log("音效播放失败:", e));
            
            // 显示烟花
            createFireworks(8);
            
            // 显示弹窗并添加动画效果
            prizeModal.style.display = "flex";
            setTimeout(() => {
                prizeModal.classList.add('active');
            }, 10);
        }

        // 关闭弹窗
        function closeModalHandler() {
            prizeModal.classList.remove('active');
            setTimeout(() => {
                prizeModal.style.display = "none";
            }, 500);
        }

        // 事件监听
        startBtn.addEventListener("click", startRolling);
        stopBtn.addEventListener("click", stopRolling);
        closeModal.addEventListener("click", closeModalHandler);

        // 初始化剩余奖品显示
        updateRemainingDisplay();
    </script>
</body>
</html>